<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<HTML lang="en"><HEAD>
<!-- BASE URL FOR LOCAL TESTING - Uncomment to load images from TFP when testing locally -->
<base href="https://www.troublefreepool.com">
<!-- END LOCAL TESTING BASE URL -->
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Pool Math helps you keep calculate your pool's chemical needs."> 
<meta name="Author" content="Jason T. Linhart">
<meta name="Copyright" content="Copyright (c) 2007-2010 by Jason T. Linhart and 2013 by TroubleFreePool.com">

<TITLE>Pool Math</TITLE>
<STYLE type="text/css" media="all">
/* === MODERNIZED STYLES === */
* {
	box-sizing: border-box;
}
body {
	background: linear-gradient(180deg, #e8f4fc 0%, #f5f9fc 100%);
	font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
	color: #333;
	line-height: 1.5;
}
td {
	font-size: 15px;
	padding: 8px;
}
h1 {
	text-align: center;
	color: #2563eb;
	font-weight: 600;
	letter-spacing: -0.5px;
	margin: 20px 0;
}
.site-header {
	display: flex;
	align-items: center;
	justify-content: center;
	gap: 48px;
	padding: 20px 0 10px;
}
.brand-link {
	display: inline-flex;
	align-items: center;
	text-decoration: none;
	color: inherit;
}
.brand-block {
	display: flex;
	flex-direction: column;
	align-items: center;
	gap: 4px;
}
.brand-logo {
	width: 90px;
	height: auto;
	color: #1e3a8a;
}
.brand-text {
	font-size: 9px;
	font-weight: 600;
	letter-spacing: 0.3px;
	color: #1e3a8a;
}
.header-title {
	font-size: 56px;
	font-weight: 700;
	color: #1e40af;
	letter-spacing: -1px;
	margin: 0;
	text-align: right;
}
@media (max-width: 720px) {
	.site-header {
		flex-direction: column;
		align-items: flex-start;
	}
	.header-title {
		text-align: left;
		font-size: 28px;
	}
}
input[type="text"], select {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, monospace;
	font-size: 13px;
	padding: 6px 10px;
	border: 1px solid #d1d5db;
	border-radius: 6px;
	background-color: #fff;
	transition: border-color 0.2s, box-shadow 0.2s;
}
input[type="text"]:focus, select:focus {
	outline: none;
	border-color: #2563eb;
	box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.15);
}
input[type="text"][readonly] {
	background-color: rgba(255, 255, 255, 0.6);
	border: 1px dashed #c7d2dc;
	cursor: default;
}
input[type="button"], button {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
	font-size: 14px;
	font-weight: 500;
	padding: 8px 16px;
	border: none;
	border-radius: 6px;
	background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
	color: #fff;
	cursor: pointer;
	transition: transform 0.1s, box-shadow 0.2s;
}
input[type="button"]:hover, button:hover {
	transform: translateY(-1px);
	box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
}
input[type="button"]:active, button:active {
	transform: translateY(0);
}
table[border="1"] {
	border-collapse: separate;
	border-spacing: 0;
	border-radius: 12px;
	overflow: hidden;
	box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
	border: none;
}
table[border="1"] > tbody > tr > td {
	border: 1px solid rgba(0, 0, 0, 0.08);
}
.sans {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
}
.ClassNORM {
	background-color: #ffffff;
}
.ClassHEAD {
	background: linear-gradient(135deg, #1e40af 0%, #1e3a8a 100%);
	color: #ffffff;
	font-weight: 500;
}
.ClassSIZE {
	background-color: #fef3c7;
}
.ClassFC {
	background-color: #fef9c3;
}
.ClassPH {
	background-color: #fce7f3;
}
.ClassTA {
	background-color: #dcfce7;
}
.ClassCH {
	background-color: #e0f2fe;
}
.ClassCYA {
	background-color: #fef9c3;
}
.ClassSALT {
	background-color: #f3f4f6;
}
.ClassBOR {
	background-color: #fce7f3;
}
.ClassTEMP {
	background-color: #fef3c7;
}
.ClassCSI {
	background-color: #dcfce7;
}
.ClassSUG {
	background-color: #e0f2fe;
}
.ClassGOALS {
	background-color: #fef9c3;
}
/* Goal value styling - makes the target ranges stand out */
.goal-label {
	font-size: 13px;
	color: #666;
	font-weight: 400;
}
.goal-value {
	font-size: 14px;
	font-weight: 600;
	color: #1e40af;
}
.goal-value.not-setup {
	color: #9ca3af;
	font-weight: 400;
	font-style: italic;
}
/* Column header styling */
.ClassHEAD td {
	font-size: 14px;
	font-weight: 600;
	text-transform: uppercase;
	letter-spacing: 0.5px;
}
/* Row label styling (FC, pH, etc) */
td[align="center"] > strong {
	font-size: 15px;
	color: #374151;
}
/* Instruction label styling (To raise, To lower, Bleach, Or) */
.instruction-label {
	color: #4b5563;
}
/* Calculated output fields - subtle highlight */
input[type="text"][readonly].result-field {
	background-color: rgba(219, 234, 254, 0.4);
	border: 1px solid #93c5fd;
	color: #1e40af;
	font-weight: 500;
}
/* Custom tooltip styling - instant display on hover */
.tooltip-trigger {
	cursor: help;
	position: relative;
}
.custom-tooltip {
	position: fixed;
	background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
	color: #fff;
	padding: 8px 12px;
	border-radius: 8px;
	font-size: 13px;
	font-weight: 500;
	white-space: nowrap;
	pointer-events: none;
	z-index: 10000;
	opacity: 0;
	transform: translateY(4px);
	transition: opacity 0.15s ease, transform 0.15s ease;
	box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25), 0 0 0 1px rgba(255, 255, 255, 0.1) inset;
}
.custom-tooltip.visible {
	opacity: 1;
	transform: translateY(0);
}
.custom-tooltip::before {
	content: '';
	position: absolute;
	top: -6px;
	left: 50%;
	transform: translateX(-50%);
	border: 6px solid transparent;
	border-bottom-color: #1e293b;
	border-top: none;
}
.custom-tooltip.above::before {
	top: auto;
	bottom: -6px;
	border-bottom: none;
	border-top-color: #334155;
}
/* Improve spacing in instruction cells */
td[colspan="2"][align="left"], td[colspan="2"][rowspan] {
	line-height: 1.8;
	padding: 12px 14px;
}
/* Style for note text at bottom of cells */
td[colspan="2"] br:last-of-type + * {
	margin-top: 6px;
}
/* Visual separator for "or" options */
.option-row {
	display: block;
	margin: 4px 0;
}
/* Style notes to stand out */
td[colspan="2"] {
	font-size: 14px;
}
/* Soften the row transitions */
tr {
	transition: background-color 0.2s;
}
/* Style the promo banner */
div[style*="margin: 12px auto"] {
	border-radius: 12px !important;
	background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%) !important;
	border: 1px solid #93c5fd !important;
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
}
</STYLE>
<SCRIPT LANGUAGE="JavaScript" type="text/javascript"><!--

var old_unit = 0;

// Use localStorage for reliable persistence (works on file:// URLs)
// Falls back to cookies for web server deployment
function createCookie(name,value,days)
{
	// Try localStorage first (works locally)
	try {
		localStorage.setItem(name, value);
	} catch(e) {}
	
	// Also set cookie for web deployment
	if (days) {
		var date = new Date();
		date.setTime(date.getTime()+(days*24*60*60*1000));
		var expires = "; expires="+date.toGMTString();
		}
	else var expires = "";
	document.cookie = name+"="+value+expires+"; path=/";
	}

function readCookie(name)
{
	// Try localStorage first
	try {
		var lsValue = localStorage.getItem(name);
		if (lsValue !== null) return lsValue;
	} catch(e) {}
	
	// Fall back to cookies
	var nameEQ = name + "=";
	var ca = document.cookie.split(';');
	for(var i=0;i < ca.length;i++) {
		var c = ca[i];
		while (c.charAt(0)==' ') c = c.substring(1,c.length);
		if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
		}
	return null;
	}

function eraseCookie(name)
{
	try {
		localStorage.removeItem(name);
	} catch(e) {}
	createCookie(name,"",-1);
	}

function SaveSettings()					// ABCDEFGHJKLMNOPQRSTUVWXYZ - I
{
	var settingsValue = "U"+document.F.Units.selectedIndex+
		"G"+parseInt(document.F.SIZE.value)+
		"Q"+parseFloat(document.F.FCpcnt.value)+
		"J"+document.F.FCjug.selectedIndex+
		"Z"+document.F.FCpop.selectedIndex+
		"V"+document.F.SZpop.selectedIndex+
		"E"+document.F.EFFpop.selectedIndex+
		"C"+parseFloat(document.F.FCto.value)+
		"P"+parseFloat(document.F.PHto.value)+
		"M"+document.F.MApop.selectedIndex+
		"A"+parseInt(document.F.TAto.value)+
		"H"+parseInt(document.F.CHto.value)+
		"F"+parseInt(document.F.CHfill.value)+
		"Y"+parseInt(document.F.CYAto.value)+
		"S"+parseInt(document.F.SALTto.value)+
		"B"+parseInt(document.F.BORto.value)+
		"X"+document.F.BORpop.selectedIndex+
		"T"+parseInt(document.F.TEMP.value)+
		"W"+parseFloat(document.F.SZwid.value)+
		"L"+parseFloat(document.F.SZlen.value)+
		"D"+parseFloat(document.F.SZdeep.value)+
		"O"+parseFloat(document.F.EFFoz.value)+
		"N"+document.F.FROMpop.selectedIndex+
		"K"+document.F.CHLORINEpop.selectedIndex+
		"R"+document.F.SURFACEpop.selectedIndex;
	createCookie("settings", settingsValue, 365);
	}

function RestoreSettings()
{
	var cookie, value, indx, len, tlen;

	cookie=readCookie("settings");
	if (cookie) len=cookie.length;
	else len=0;
	for (indx=0; indx+2<=len; indx=tlen) {
		for (tlen=indx+1; tlen<len && (cookie.charAt(tlen)=="." || 
			(cookie.charAt(tlen)>="0" && cookie.charAt(tlen)<="9")); ++tlen) ;
		if (tlen<=indx+1) break;
		value=parseFloat(cookie.substring(indx+1,tlen));
		switch (cookie.charAt(indx)) {

		case "U":
			document.F.Units.selectedIndex=old_unit=value;
			if (value>0) CalcUnits();
			break;
		case "G":
			document.F.SIZE.value=value;
			break;
		case "Q":
			document.F.FCpcnt.value=value;
			break;
		case "J":
			document.F.FCjug.selectedIndex=value;
			break;
		case "Z":
			document.F.FCpop.selectedIndex=value;
			break;
		case "V":
			document.F.SZpop.selectedIndex=value;
			break;
		case "E":
			document.F.EFFpop.selectedIndex=value;
			break;
		case "C":
			document.F.FCfrom.value=document.F.FCto.value=value;
			break;
		case "F":
			document.F.CHfill.value=value;
			break;
		case "P":
			document.F.PHfrom.value=document.F.PHto.value=value;
			break;
		case "M":
			document.F.MApop.selectedIndex=value;
			break;
		case "A":
			document.F.TAfrom.value=document.F.TAto.value=value;
			break;
		case "H":
			document.F.CHfrom.value=document.F.CHto.value=value;
			break;
		case "Y":
			document.F.CYAfrom.value=document.F.CYAto.value=value;
			break;
		case "S":
			document.F.SALTfrom.value=document.F.SALTto.value=value;
			break;
		case "B":
			document.F.BORfrom.value=document.F.BORto.value=value;
			break;
		case "X":
			document.F.BORpop.selectedIndex=value;
			break;
		case "T":
			document.F.TEMP.value=value;
			break;
		case "W":
			document.F.SZwid.value=value;
			break;
		case "L":
			document.F.SZlen.value=value;
			break;
		case "D":
			document.F.SZdeep.value=value;
			break;
		case "O":
			document.F.EFFoz.value=value;
			break;
		case "N":
			document.F.FROMpop.selectedIndex=value;
			break;
		case "K":
			document.F.CHLORINEpop.selectedIndex=value;
			break;
		case "R":
			document.F.SURFACEpop.selectedIndex=value;
			break;
			}
		}
	CalcAll();
	}

function GetGallons()
{
	if (document.F.Units.selectedIndex==1)
		return(parseInt(document.F.SIZE.value)/3.78541);
	if (document.F.Units.selectedIndex==2)
		return(parseInt(document.F.SIZE.value)*1.20095);
	return(parseInt(document.F.SIZE.value));
	}

function PutWeight(oz)
{
	if (document.F.Units.selectedIndex==1)
		return(Math.floor(oz*28.3495 + 0.5)+" g");
	if (oz<10) return(Math.floor(oz+0.05)+"."+Math.floor(oz*10+0.5)%10+" oz");
	return(Math.floor(oz+0.5)+" oz");
	}

function PutLbs(oz)
{
	if (document.F.Units.selectedIndex==1)
		return(Math.floor(oz*0.0283495 + 0.5)+" kg");
	return(Math.floor(oz/16+0.5)+" lbs");
	}

function PutVolume(oz)
{
	if (document.F.Units.selectedIndex==1)
		return(Math.floor(oz*29.5735 + 0.5)+" ml");
	if (document.F.Units.selectedIndex==2) oz*=1.04084;
	if (oz<10) return(Math.floor(oz+0.05)+"."+Math.floor(oz*10+0.5)%10+" oz");
	return(Math.floor(oz+0.5)+" oz");
	}

function PutGallons(gal)
{
	if (document.F.Units.selectedIndex==1)
		return(Math.floor(gal/7.48052*10 + 0.5)*100 + " liters");
	if (document.F.Units.selectedIndex==2) gal*=0.832674;
	if (gal<1000) return(Math.floor(gal / 10 + 0.5) * 10 +" gallons");
	return(Math.floor(gal / 100 + 0.5) * 100 +" gallons");
	}

function CalcFC()
{
	var ozmul = [6854.95, 4149.03, 3565.44, 3936.84, 4828.12, 5422.41, 2637.5, 7489.4];
	var vol = ["X", 0.9351, 0.9352, 0.9352, 0.9352, 0.9352, 0.978, "X"];
	var temp;

	pcnt=parseFloat(document.F.FCpcnt.value);
	document.F.FCtrade.value=(pcnt>9?"trade":"weight");
	if (parseFloat(document.F.FCfrom.value)<parseFloat(document.F.FCto.value)) {
		// Bleach
		temp=(parseFloat(document.F.FCto.value)-
			parseFloat(document.F.FCfrom.value)) * 
			GetGallons() / ((75.71*pcnt + 0.746*pcnt*pcnt)*
			(pcnt>9?(1.02-0.008*pcnt):1));
		document.F.FC1oz.value=PutVolume(temp);

		// Trichlor, Dichlor, Cal-hypo 48%, 53%, 65%, 73%, 
		// Lith-hypo, Chlorine Gas
		temp=(parseFloat(document.F.FCto.value)-
			parseFloat(document.F.FCfrom.value)) *
			GetGallons() / ozmul[document.F.FCpop.selectedIndex];
		document.F.FC2oz.value=PutWeight(temp);
		if (vol[document.F.FCpop.selectedIndex]=="X")
			document.F.FC2vol.value="unknown";
		else document.F.FC2vol.value=PutVolume(temp *
			vol[document.F.FCpop.selectedIndex]);
		}
	else {
		document.F.FC1oz.value=0;
		document.F.FC2oz.value=document.F.FC2vol.value=0;
		}
	}

function CalcPH()
{
	var mamul = [2.0, 1.11111, 1.0, .909091, 2.16897, 1.08448 ];
	var temp, adj, delta, extra;

	delta=parseFloat(document.F.PHto.value)-parseFloat(document.F.PHfrom.value);
	delta*=GetGallons();
	temp=(parseFloat(document.F.PHfrom.value)+
		parseFloat(document.F.PHto.value))/2;
	adj=(192.1626 + -60.1221*temp + 6.0752*temp*temp + -0.1943*temp*temp*temp) *
		(parseInt(document.F.TAfrom.value)+13.91) / 114.6;
	extra=(-5.476259 + 2.414292*temp + -0.355882*temp*temp +
		0.01755*temp*temp*temp) * parseInt(document.F.BORfrom.value);
	extra*=delta;
	delta*=adj;
	if (parseFloat(document.F.PHfrom.value)<parseFloat(document.F.PHto.value)) {
		// Washing soda, soda ash
		temp=(delta/218.68)+(extra/218.68);
		document.F.PHU1oz.value=PutWeight(temp);
		document.F.PHU1vol.value=PutVolume(temp * 0.8715);

		// Borax
		temp=(delta/110.05)+(extra/110.05);
		document.F.PHU2oz.value=PutWeight(temp);
		document.F.PHU2vol.value=PutVolume(temp * 0.9586);
		}
	else {
		document.F.PHU1oz.value=document.F.PHU1vol.value=0;
		document.F.PHU2oz.value=document.F.PHU2vol.value=0;
		}

	if (parseFloat(document.F.PHfrom.value)>parseFloat(document.F.PHto.value)) {
		// Muriatic acid
		temp=(delta / -240.15 * mamul[document.F.MApop.selectedIndex])+
			(extra / -240.15 * mamul[document.F.MApop.selectedIndex]);
		document.F.PHD1oz.value=PutVolume(temp);

		// Dry acid
		temp=(delta/-178.66)+(extra/-178.66);
		document.F.PHD2oz.value=PutWeight(temp);
		document.F.PHD2vol.value=PutVolume(temp * 0.6657);
		}
	else {
		document.F.PHD1oz.value=0;
		document.F.PHD2oz.value=document.F.PHD2vol.value=0;
		}
	}

function CalcTA()
{
	var temp;

	document.F.PHTA.value=parseInt(document.F.TAfrom.value);
	if (parseInt(document.F.TAfrom.value) < parseInt(document.F.TAto.value)) {
		// Baking soda
		temp=(parseInt(document.F.TAto.value)-
			parseInt(document.F.TAfrom.value)) *
			GetGallons() / 4259.15;
		document.F.TAoz.value=PutWeight(temp);
		document.F.TAvol.value=PutVolume(temp * 0.7988);
		}
	else document.F.TAoz.value=document.F.TAvol.value=0;
}

function CalcCH()
{
	var temp;

	if (parseInt(document.F.CHfrom.value) < parseInt(document.F.CHto.value)) {
		// Calcium chloride
		temp=(parseInt(document.F.CHto.value)-
			parseInt(document.F.CHfrom.value)) *
			GetGallons() / 6754.11;
		document.F.CH1oz.value=PutWeight(temp);
		document.F.CH1vol.value=PutVolume(temp * 0.7988);

		// Calcium chloride dihydrate	
		temp=(parseInt(document.F.CHto.value)-
			parseInt(document.F.CHfrom.value)) *
			GetGallons() / 5098.82;
		document.F.CH2oz.value=PutWeight(temp);
		document.F.CH2vol.value=PutVolume(temp * 1.148);
		document.F.CHpcnt.value="some";
		}
	else {
		document.F.CH1oz.value=document.F.CH1vol.value=0;
		document.F.CH2oz.value=document.F.CH2vol.value=0;
		if (parseInt(document.F.CHfrom.value) > 
			 parseInt(document.F.CHto.value)) {
			if (parseInt(document.F.CHto.value) <
				 parseInt(document.F.CHfill.value))
				document.F.CHpcnt.value="can't";
			else document.F.CHpcnt.value=Math.floor(100-
				((parseInt(document.F.CHto.value)-
					parseInt(document.F.CHfill.value)) /
				(parseInt(document.F.CHfrom.value)-
					parseInt(document.F.CHfill.value)))*100+0.5) + "%";
			}
		else document.F.CHpcnt.value="some";
		}
	}

function CalcCYA()
{
	var temp;

	if (parseInt(document.F.CYAfrom.value) < parseInt(document.F.CYAto.value)) {
		// Stabilizer
		temp=(parseInt(document.F.CYAto.value)-
			parseInt(document.F.CYAfrom.value)) *
			GetGallons() / 7489.51;
		document.F.CYA1oz.value=PutWeight(temp);
		document.F.CYA1vol.value=PutVolume(temp * 1.042);
		temp=(parseInt(document.F.CYAto.value)-
			parseInt(document.F.CYAfrom.value)) *
			GetGallons() / 2890;
		document.F.CYA2oz.value=PutVolume(temp);
		document.F.CYApcnt.value="some";
		}
	else {
		document.F.CYA1oz.value=document.F.CYA1vol.value=
			document.F.CYA2oz.value=0;
		if (parseInt(document.F.CYAfrom.value) >
			parseInt(document.F.CYAto.value)) document.F.CYApcnt.value=
				Math.floor(100-(parseInt(document.F.CYAto.value)/
				parseInt(document.F.CYAfrom.value))*100+0.5) + "%";
		else document.F.CYApcnt.value="some";
		}
	}

function CalcSALT()
{
	var temp;

	if (parseInt(document.F.SALTfrom.value)<parseInt(document.F.SALTto.value)) {
		// Salt
		temp=(parseInt(document.F.SALTto.value)-
			parseInt(document.F.SALTfrom.value)) *
			GetGallons() / 7468.64;
		document.F.SALTlb.value=PutLbs(temp);
		document.F.SALTpcnt.value="some";
		}
	else {
		document.F.SALTlb.value=0;
		if (parseInt(document.F.SALTfrom.value) >
			parseInt(document.F.SALTto.value)) document.F.SALTpcnt.value=
				Math.floor(100-(parseInt(document.F.SALTto.value)/
				parseInt(document.F.SALTfrom.value))*100+0.5) + "%";
		else document.F.SALTpcnt.value="some";
		}
	}

function CalcBOR()
{
	var bormul = [ 849.271, 1309.52, 1111.69 ];
	var temp;

	document.F.PHBOR.value=parseInt(document.F.BORfrom.value);
	if (parseInt(document.F.BORfrom.value) < parseInt(document.F.BORto.value)) {
		// Borax & boric acid
		temp=(parseInt(document.F.BORto.value)-
			parseInt(document.F.BORfrom.value)) *
			GetGallons() / bormul[document.F.BORpop.selectedIndex];
		document.F.BORoz.value=PutWeight(temp);
		if (document.F.BORpop.selectedIndex==1) {
			document.F.BORvol.value=PutVolume(temp * 1.075);
			document.F.BORacid.value=0;
			}
		else if (document.F.BORpop.selectedIndex==2) {
			document.F.BORvol.value=PutVolume(temp * 0.5296);
			document.F.BORacid.value=PutVolume(temp * 0.624);	// Muriatic acid
			}
		else {
			document.F.BORvol.value=PutVolume(temp * 0.9586);
			document.F.BORacid.value=PutVolume(temp * 0.4765);	// Muriatic acid
			}
		document.F.BORpcnt.value="some";
		}
	else {
		document.F.BORoz.value=document.F.BORvol.value=0;
		document.F.BORacid.value=0;
		if (parseInt(document.F.BORfrom.value) >
			parseInt(document.F.BORto.value)) document.F.BORpcnt.value=
				Math.floor(100-(parseInt(document.F.BORto.value)/
				parseInt(document.F.BORfrom.value))*100+0.5) + "%";
		else document.F.BORpcnt.value="some";
		}
	}

function CSI(PH,TA,CH,CYA,Salt,Borate,Temp)
{
	var Sodium, extra_NaCl, CarbAlk, Ionic, TDS, CSI;

	if (PH<6 || PH>9 || isNaN(PH)) return("PH Err");
	TA=parseInt(TA);
	CH=parseInt(CH);
	CYA=parseInt(CYA)
	Salt=parseInt(Salt);
	Borate=parseInt(Borate);
	if (document.F.Units.selectedIndex!=1) Temp=(parseInt(Temp)-32)*5/9;
	else Temp=parseInt(Temp);
//	if (Salt<=0) Salt = CH*1.1678 + TA*1.6859 + Borate*2.6976;
//	Sodium = 23*( (TA - CYA/3)*2/100 + CYA/129 + Salt/58.4 - 2*CH/100 );
//	TDS = CH*(40/100) + (TA - CYA/3)*2*(61/100) + CYA*(128/129) +
//		Borate*(61.8/10.8) + Salt*(35.5/58.4) + Sodium;
	CarbAlk = TA - 0.38772*CYA/(1+Math.pow(10,6.83-PH)) -
		4.63*Borate/(1+Math.pow(10,9.11-PH));
//	extra_NaCl = TDS - (1.109*CH + 1.679*CarbAlk + CYA);
	extra_NaCl = Salt - 1.1678*CH;
	if (extra_NaCl<0) extra_NaCl=0;
	Ionic = (1.5*CH+1*TA)/50045 + extra_NaCl/58440;
	CSI = PH-11.677 + Math.log(CH)/Math.LN10 + Math.log(CarbAlk)/Math.LN10 -
		2.56*Math.sqrt(Ionic)/(1+1.65*Math.sqrt(Ionic)) - 
		1412.5/(Temp+273.15) + 4.7375;
	return(Math.floor(CSI*100+0.5)/100);
	}

function CalcCSIfrom()
{
	document.F.CSIfrom.value=CSI(document.F.PHfrom.value,
		document.F.TAfrom.value,document.F.CHfrom.value,
		document.F.CYAfrom.value,document.F.SALTfrom.value,
		document.F.BORfrom.value,document.F.TEMP.value);
	}

function CalcCSIto()
{
	document.F.CSIto.value=CSI(document.F.PHto.value,
		document.F.TAto.value,document.F.CHto.value,
		document.F.CYAto.value,document.F.SALTto.value,
		document.F.BORto.value,document.F.TEMP.value);
	SaveSettings();
	}

function CalcSUG()
{
	var cya;
	var fcGoal = document.getElementById("FCgoal");

	cya=parseInt(document.F.CYAfrom.value);
	document.F.SUGFCswg.value=Math.max(1,Math.floor(cya*0.045+0.7));
	document.F.SUGFCmin.value=Math.max(1,Math.floor(cya*0.075+0.7));
	document.F.SUGFCtarg.value=Math.max(3,Math.floor(cya/10+3.5));
	document.F.SUGFCshock.value=Math.max(10,Math.floor(cya*0.393+0.5));
	document.F.SUGFCmust.value=Math.max(12,Math.floor(cya/2+4.5));
	if (document.F.FROMpop.selectedIndex==0) {
		fcGoal.innerHTML="Not Setup";
		fcGoal.className="goal-value not-setup";
	}
	else if (document.F.FROMpop.selectedIndex==3) {
		fcGoal.innerHTML="1 to 6";
		fcGoal.className="goal-value";
	}
	else {
		fcGoal.innerHTML=
			((document.F.CHLORINEpop.selectedIndex==2)?
			  document.F.SUGFCswg.value:document.F.SUGFCmin.value)+
			" to "+document.F.SUGFCtarg.value;
		fcGoal.className="goal-value";
	}
	}

function CalcGOAL()
{
	var from, chlorine, surface;

	CalcSUG();
	from=document.F.FROMpop.selectedIndex;
	chlorine=document.F.CHLORINEpop.selectedIndex;
	document.F.CHLORINEpop.disabled=(from==3);
	surface=document.F.SURFACEpop.selectedIndex;
	document.F.SURFACEpop.disabled=(from==3);
	if (from==0 || (from==2 && (chlorine==0 || surface==0))) {
		document.getElementById("PHgoal").innerHTML="Not Setup";
		document.getElementById("PHgoal").className="goal-value not-setup";
		document.getElementById("TAgoal").innerHTML="Not Setup";
		document.getElementById("TAgoal").className="goal-value not-setup";
		document.getElementById("CHgoal").innerHTML="Not Setup";
		document.getElementById("CHgoal").className="goal-value not-setup";
		document.getElementById("CYAgoal").innerHTML="Not Setup";
		document.getElementById("CYAgoal").className="goal-value not-setup";
		}
	else if (from==1) {
		document.getElementById("PHgoal").innerHTML="7.2 to 7.8";
		document.getElementById("PHgoal").className="goal-value";
		document.getElementById("TAgoal").innerHTML="80 to 120";
		document.getElementById("TAgoal").className="goal-value";
		document.getElementById("CHgoal").innerHTML="200 to 400";
		document.getElementById("CHgoal").className="goal-value";
		document.getElementById("CYAgoal").innerHTML="30 to 80";
		document.getElementById("CYAgoal").className="goal-value";
		}
	else if (from==2) {
		document.getElementById("PHgoal").innerHTML="7.5 to 7.8";
		document.getElementById("PHgoal").className="goal-value";
		document.getElementById("TAgoal").innerHTML=(chlorine==1)?(surface==2 && chlorine==1)?"50 to 90+":
			"70 to 90+":(chlorine==2)?"60 to 80":
"100 to 120+";
		document.getElementById("TAgoal").className="goal-value";
		document.getElementById("CHgoal").innerHTML=(surface==1 && (chlorine==1 || chlorine==3))?"250 to 350":
		(surface==1 && chlorine==2)?"350 to 450":(surface==2 && (chlorine==1 || chlorine==3))?"0 to 350":
		(surface==2 && chlorine==2)? "0 to 300":"220 to 320";
		document.getElementById("CHgoal").className="goal-value";
		document.getElementById("CYAgoal").innerHTML=(chlorine==2)?
			"70 to 80":"30 to 50";
		document.getElementById("CYAgoal").className="goal-value";
		}
	else if (from==3) {
		document.getElementById("PHgoal").innerHTML="7.4 to 7.8";
		document.getElementById("PHgoal").className="goal-value";
		document.getElementById("TAgoal").innerHTML="50 to 80";
		document.getElementById("TAgoal").className="goal-value";
		document.getElementById("CHgoal").innerHTML="120 to 200";
		document.getElementById("CHgoal").className="goal-value";
		document.getElementById("CYAgoal").innerHTML="20 to 40";
		document.getElementById("CYAgoal").className="goal-value";
		}
	}

function CalcSZ()
{
	var volmult = [7.48052, 7.48052, 5.87518];
	var temp, wid, len;

	wid=parseFloat(document.F.SZwid.value);
	len=parseFloat(document.F.SZlen.value);
	if (document.F.SZpop.selectedIndex==2) {
		len=wid;
		document.F.SZlen.style.color=document.F.SZunit2.style.color="#BBBBBB";
		document.F.SZlen.readOnly=true;
		}
	else {
		document.F.SZlen.style.color=document.F.SZunit2.style.color="#000000";
		document.F.SZlen.readOnly=false;
		}
	if (document.F.SZpop.selectedIndex==1 && len<wid) {
		temp=wid;
		wid=len;
		len=temp;
		}
	temp=wid*len;
	if (document.F.SZpop.selectedIndex==1) temp=temp - 0.214602*wid*wid;
	temp=temp * parseFloat(document.F.SZdeep.value) *
		volmult[document.F.SZpop.selectedIndex];
	document.F.SZvol.value=PutGallons(temp);
	SaveSettings();
	}

var eff_units = [ 0, 0, 0, 0, 0, 1, 1, 1, 1, 1,
				  1, 1, 1, 0, 0, 1, 1, 1, 1, 1,
				  1, 1, 1, 1, 1, 0, 2 ];
		// 0-volume(oz,ml), 1-weight(oz,g), 2-weight(lbs,kg)
		
function Format(value)
{
	if (value<9.95) return(Math.floor(value*10+0.5)/10);
	else return(Math.floor(value+0.5));
	}

function CalcEFF()
{
	var oz, unit, result;

	oz=parseFloat(document.F.EFFoz.value);
	unit=eff_units[document.F.EFFpop.selectedIndex];
	if (document.F.Units.selectedIndex==1) {		// Metric
		if (unit==1) {
			document.F.EFFunit.value="g";
			oz=oz*0.035274;
			}
		else if (unit==2) {
			document.F.EFFunit.value="kg";
			oz=oz*2.20462;
			}
		else {
			document.F.EFFunit.value="ml";
			oz=oz*0.033814;
			}
		}
	else if (document.F.Units.selectedIndex==2) {	// Imperial
		if (unit==2) document.F.EFFunit.value="lbs";
		else {
			document.F.EFFunit.value="oz";
			if (unit==0) oz=oz*0.96076;
			}
		}
	else {											// U.S.
		if (unit==2) document.F.EFFunit.value="lbs";
		else document.F.EFFunit.value="oz";
		}
	switch (document.F.EFFpop.selectedIndex) {

	case 0:					// 5.25% bleach
		oz=oz*525/600;
	case 1:					// 6% bleach
		oz=oz*600/825;
	case 2:
		oz=oz*0.84867552;
	case 3:					// 10% bleach
		oz=oz*100/125;
	case 4:					// 12.5% bleach
		result="raise FC by "+Format(oz / GetGallons() * 976.562);
		result=result+" and raise Salt by "+Format(oz / GetGallons() *
			1607);
		break;
	case 5:					// trichlor
		result="raise FC by "+Format(oz / GetGallons() * 6854.95);
		result=result+", raise CYA by "+Format(oz / GetGallons() *
			4159.41);
		result=result+", lower pH by "+Math.floor(oz / GetGallons() *
			367 * 100 + 0.5) / 100;
		result=result+", and raise Salt by "+Format(oz / GetGallons() *
			5600);
		break;
	case 6:					// dichlor
		result="raise FC by "+Format(oz / GetGallons() * 4149.03);
		result=result+", raise CYA by "+Format(oz / GetGallons() *
			3776.46);
		result=result+", lower pH by "+Math.floor(oz / GetGallons() *
			158 * 100 + 0.5) / 100;
		result=result+", and raise Salt by "+Format(oz / GetGallons() *
			3384);
		break;
	case 7:					// 48% cal-hypo
		oz=oz*48/53;
	case 8:					// 53% cal-hypo
		oz=oz*53/65;
	case 9:					// 65% cal-hypo
		oz=oz*65/73;
	case 10:				// 73% cal-hypo
		result="raise FC by "+Format(oz / GetGallons() * 5422.41);
		result=result+", raise CH by "+Format(oz / GetGallons() *
			3827.09);
		result=result+", and raise Salt by "+Format(oz / GetGallons() *
			5500);
		break;
	case 11:					// lithium hypochlorite
		result="raise FC by "+Format(oz / GetGallons() * 2637.5);
		result=result+" and raise Salt by "+Format(oz / GetGallons() *
			4170);
		break;
	case 12:				// chlorine gas
		result="raise FC by "+Format(oz / GetGallons() * 7489.4);
		result=result+", lower pH by "+Math.floor(oz / GetGallons() * 625 * 
			100 + 0.5) / 100;
		result=result+", and raise Salt by "+Format(oz / GetGallons() *
			6140);
		break;
	case 13:				// 15.725% muriatic acid
		oz=oz/2;
	case 14:				// 31.45% muriatic acid
		result="lower pH by "+Math.floor(oz / GetGallons() * 240.15 * 
			100 + 0.5) / 100;
		result=result+" and lower TA by "+Format(oz / GetGallons() *
			3911.47);
		break;
	case 15:				// dry acid
		result="lower pH by "+Math.floor(oz / GetGallons() * 167.9 * 
			100 + 0.5) / 100;
		result=result+" and lower TA by "+Format(oz / GetGallons() *
			2909.47);
		break;
	case 16:				// washing soda or soda ash
		result="raise pH by "+Math.floor(oz / GetGallons() * 217.1 * 
			100 + 0.5) / 100;
		result=result+" and raise TA by "+Format(oz / GetGallons() *
			7072.46);
		break;
	case 17:				// borax (20 Mule Team)
		result="raise pH by "+Math.floor(oz / GetGallons() * 109.1 * 
			100 + 0.5) / 100;
		result=result+", raise Borate by "+Format(oz / GetGallons() *
			849.271);
		result=result+", and raise TA by "+Format(oz / GetGallons() *
			1949.93);
		break;
	case 18:				// sodium tetraborate pentahydrate
		result="raise pH by "+Math.floor(oz / GetGallons() * 166.8 * 
			100 + 0.5) / 100;
		result=result+", raise Borate by "+Format(oz / GetGallons() *
			1111.69);
		result=result+", and raise TA by "+Format(oz / GetGallons() *
			2548.89);
		break;
	case 19:				// boric acid
		result="raise Borate by "+Format(oz / GetGallons() * 1309.52);
		result=result+" and lower PH by "+Math.floor(oz / GetGallons() * 
			7.559 * 100 + 0.5) / 100;
		break;
	case 20:				// caustic soda (lye)
		result="raise pH by "+Math.floor(oz / GetGallons() * 546.3 * 
			100 + 0.5) / 100;
		result=result+" and raise TA by "+Format(oz / GetGallons() *
			9135.78);
		break;
	case 21:				// baking soda
		result="raise TA by "+Format(oz / GetGallons() * 4461.56);
		result=result+" and raise pH by "+Math.floor(oz / GetGallons() *
			9.091 * 100 + 0.5) / 100;
		break;
	case 22:				// calcium chloride
		result="raise CH by "+Format(oz / GetGallons() * 6754.11);
		break;
	case 23:				// calcium chloride dihydrate
		result="raise CH by "+Format(oz / GetGallons() * 5098.82);
		break;
	case 24:				// stabilizer
		result="raise CYA by "+Format(oz / GetGallons() * 7489.51);
		result=result+" and lower pH by "+Math.floor(oz / GetGallons() *
			138.8 * 100 + 0.5) / 100;
		break;
	case 25:				// liquid stabilizer
		result="raise CYA by "+Format(oz / GetGallons() * 2890);
		break;
	case 26:				// salt
		result="raise Salt by "+Format(oz / GetGallons() * 7468.64 *
			16);
		break;
		}
	document.F.EFFresult.value=result+".";
	SaveSettings();
	}

function CalcEFFUnits(new_unit,old)
{
	var unit=eff_units[document.F.EFFpop.selectedIndex];
	var factor;

	if (new_unit==0) {
		if (old==1) {				// Metric to US
			if (unit==0) factor=0.033814;		// Liquid
			else if (unit==1) factor=0.035274;	// Weight
			else if (unit==2) factor=2.20462;	// Lbs/kg
			}
		else if (old==2) {			// Imperial to US
			if (unit==0) factor=0.96076;		// Liquid
			else if (unit==1) factor=1;			// Weight
			else if (unit==2) factor=1;			// Lbs/kg
			}
		}
	else if (new_unit==1) {
		if (old==0) {				// US to Metric
			if (unit==0) factor=29.5735;		// Liquid
			else if (unit==1) factor=28.3495;	// Weight
			else if (unit==2) factor=0.453592;	// Lbs/kg
			}
		else if (old==2) {			// Imperial to Metric
			if (unit==0) factor=28.4131;		// Liquid
			else if (unit==1) factor=28.3495;	// Weight
			else if (unit==2) factor=0.453592;	// Lbs/kg
			}
		}
	else if (new_unit==2) {
		if (old==0) {				// US to Imperial
			if (unit==0) factor=1.04084;		// Liquid
			else if (unit==1) factor=1;			// Weight
			else if (unit==2) factor=1;			// Lbs/kg
			}
		else if (old==1) {			// Metric to Imperial
			if (unit==0) factor=0.0351951;		// Liquid
			else if (unit==1) factor=0.035274;	// Weight
			else if (unit==2) factor=2.20462;	// Lbs/kg
			}
		}
	document.F.EFFoz.value=Math.floor(parseFloat(document.F.EFFoz.value)*
		factor + 0.5);
	}

function CalcAll()
{
	CalcFC();
	CalcPH();
	CalcTA();
	CalcCH();
	CalcCYA();
	CalcSALT();
	CalcBOR();
	CalcCSIfrom();
	CalcCSIto();
	CalcSUG();
	CalcGOAL();
	CalcSZ();
	CalcEFF();
	}

function CalcUnits()
{
	if (document.F.Units.selectedIndex==1) {
		document.F.SIZEunit.value="liters";
		document.F.TEMPunit.value="Celsius";
		document.F.SZunit1.value=document.F.SZunit2.value=
			document.F.SZunit3.value="m";
		document.F.FCjug.options[0].text="2 liter";
		document.F.FCjug.options[1].text="2.85 liter";
		document.F.FCjug.options[2].text="3.6 liter";
		document.F.FCjug.options[3].text="5 liter";
		if (old_unit==0) document.F.SIZE.value=
			Math.floor(parseInt(document.F.SIZE.value)*3.78541+0.5);
		else if (old_unit==2) document.F.SIZE.value=
			Math.floor(parseInt(document.F.SIZE.value)*4.54609+0.5);
		if (old_unit!=1) document.F.TEMP.value=
			Math.floor((parseInt(document.F.TEMP.value)-32)*5/9+0.5);
		}
	else {
		document.F.SIZEunit.value="gallons";
		document.F.TEMPunit.value="Fahrenheit";
		document.F.SZunit1.value=document.F.SZunit2.value=
			document.F.SZunit3.value="ft";
		document.F.FCjug.options[0].text="96 oz";
		document.F.FCjug.options[1].text="128 oz";
		document.F.FCjug.options[2].text="174 oz";
		document.F.FCjug.options[3].text="182 oz";
		if (document.F.Units.selectedIndex==2) {
			if (old_unit==0) document.F.SIZE.value=
				Math.floor(parseInt(document.F.SIZE.value)*0.832674+0.5);
			else if (old_unit==1) document.F.SIZE.value=
				Math.floor(parseInt(document.F.SIZE.value)*0.219969+0.5);
			}
		else {
			if (old_unit==1) document.F.SIZE.value=
				Math.floor(parseInt(document.F.SIZE.value)*0.264172+0.5);
			else if (old_unit==2) document.F.SIZE.value=
				Math.floor(parseInt(document.F.SIZE.value)*1.20095+0.5);
			}
		if (old_unit==1) document.F.TEMP.value=
			Math.floor(parseInt(document.F.TEMP.value)*9/5+0.5)+32;
		}
	CalcEFFUnits(document.F.Units.selectedIndex,old_unit);
	CalcAll();
	old_unit=document.F.Units.selectedIndex;
	}

// Custom tooltip system - instant display on hover
var tooltipElement = null;
var currentTooltipElement = null;
var tooltipText = '';

function createTooltipElement() {
	if (!tooltipElement) {
		tooltipElement = document.createElement('div');
		tooltipElement.className = 'custom-tooltip';
		document.body.appendChild(tooltipElement);
	}
	return tooltipElement;
}

function setTooltip(text) {
	tooltipText = text;
}

function showTooltip(el) {
	var displayText = tooltipText;
	
	// Show "N/A" for empty or "None" values for consistency
	if (!tooltipText || tooltipText === 'None') {
		displayText = 'N/A';
	}
	
	var tooltip = createTooltipElement();
	tooltip.textContent = displayText;
	tooltip.classList.remove('above');
	
	// Position near the element
	var rect = el.getBoundingClientRect();
	var tooltipRect;
	
	// Make visible to measure
	tooltip.style.visibility = 'hidden';
	tooltip.classList.add('visible');
	tooltipRect = tooltip.getBoundingClientRect();
	tooltip.style.visibility = '';
	
	// Calculate position (centered below element)
	var left = rect.left + (rect.width / 2) - (tooltipRect.width / 2);
	var top = rect.bottom + 8;
	
	// Keep within viewport
	if (left < 8) left = 8;
	if (left + tooltipRect.width > window.innerWidth - 8) {
		left = window.innerWidth - tooltipRect.width - 8;
	}
	
	// If would go below viewport, show above instead
	if (top + tooltipRect.height > window.innerHeight - 8) {
		top = rect.top - tooltipRect.height - 8;
		tooltip.classList.add('above');
	}
	
	tooltip.style.left = left + 'px';
	tooltip.style.top = top + 'px';
	tooltip.classList.add('visible');
}

function hideTooltip() {
	if (tooltipElement) {
		tooltipElement.classList.remove('visible');
	}
	tooltipText = '';
}

function withTooltip(el, fn) {
	currentTooltipElement = el;
	tooltipText = '';
	fn();
	showTooltip(el);
	
	// Add mouseout handler if not already added
	if (!el._tooltipBound) {
		el._tooltipBound = true;
		el.addEventListener('mouseout', hideTooltip);
		el.addEventListener('blur', hideTooltip);
	}
}

function StatusWeight(oz)
{
	var result;
	oz=parseFloat(oz);
	if (document.F.Units.selectedIndex==1) {
		if (oz==0) result="None";
		else {
			if (oz>10000) oz=Math.floor((oz+500)/1000)*1000;
			else if (oz>1000) oz=Math.floor((oz+50)/100)*100;
			else if (oz>100) oz=Math.floor((oz+5)/10)*10;
			result=oz/1000+" kg";
			}
		}
	else {
		if (oz<0) result=oz+" oz";
		else if (oz==0) result="None";
		else {
			if (oz>=16) {
				if (oz>10*16) oz=Math.floor((oz+8)/16)*16;
				result=(Math.floor(oz/16))+" lb";
				if (oz>=2*16)
					result=result+"s";
				oz=oz-Math.floor(oz/16)*16;
				if (oz>0) 
					result=result+" ";
				}
			else result="";
			if (oz>0) result=result+
				oz+" oz";
			}
		}
	setTooltip(result);
	return result;
	}

function StatusVolume(oz)
{
	var div, tsp, result;

	oz=parseFloat(oz);
	if (document.F.Units.selectedIndex==1) {
		if (oz==0) result="None";
		else {
			if (oz>10000) oz=Math.floor((oz+500)/1000)*1000;
			else if (oz>1000) oz=Math.floor((oz+50)/100)*100;
			else if (oz>100) oz=Math.floor((oz+5)/10)*10;
			result=oz/1000+" liters";
			}
		}
	else {
		if (oz<0) result=oz+" oz";
		else if (oz==0) result="None";
		else {
			if (document.F.Units.selectedIndex==2) {
				div=160;
				tsp=0.5/4.8;
				}
			else {
				div=128;
				tsp=0.5/6;
				}
			if (oz>10*div) oz=Math.floor((oz+div/2)/div)*div;
			else if (oz>10*div/4) oz=Math.floor((oz+div/8)/(div/4))*(div/4);
			else if (oz>10*div/16) oz=Math.floor((oz+div/32)/(div/16))*(div/16);
			if (oz>=div) {
				result=(Math.floor(oz/div))+" gallon";
				if (oz>=2*div) result=
					result+"s";
				oz=oz-Math.floor(oz/div)*div;
				if (oz>0) result=result+" ";
				}
			else result="";
			div=div/4;
			if (oz>=div) {
				result=result+
					Math.floor(oz/div)+" quart";
				if (oz>=2*div) result=
					result+"s";
				oz=oz-Math.floor(oz/div)*div;
				if (oz>0) result=result+" ";
				}
			div=div/4;
			if (oz>=div) {
				result=result+
					Math.floor(oz/div)+" cup";
				if (oz>=2*div) result=
					result+"s";
				oz=oz-Math.floor(oz/div)*div;
				if (oz>0) result=result+" ";
				}
			if (oz>=1-tsp) {
				result=result+
					Math.floor(oz+tsp)+" oz";
				oz=oz-Math.floor(oz+tsp);
				if (oz<0) oz=0;
				if (oz>=tsp) result=
					result+" ";
				}
			if (oz>=tsp) result=result+
				Math.floor((oz+tsp)/(tsp*2))+" tsp";
			}
		}
	setTooltip(result);
	return result;
	}

function StatusBleach(oz)
{
	var jugoz = [96, 128, 174, 182, 30, 64, 121];
	var jugliter = [2000, 2850, 3600, 5000, 887, 1893, 3578];
	var jug, result;

	result = StatusVolume(oz);
	oz=parseInt(oz);
	if (document.F.Units.selectedIndex==1) {
		jug=jugliter[document.F.FCjug.selectedIndex];
		if (oz>=jug) {
			if (oz>jug*10) result=result+
				" or "+ Math.floor((oz+jug/2)/jug)+" ("+jug/1000+" liter) jugs";
			else result=result+" or "+
				Math.floor(oz/jug*10+0.5)/10+" ("+jug/1000+" liter) jugs";
			}
		}
	else {
		jug=jugoz[document.F.FCjug.selectedIndex];
		if (oz>=jug) {
			if (oz>jug*10) result=result+
				" or "+ Math.floor((oz+jug/2)/jug)+" ("+jug+" oz) jugs";
			else result=result+" or "+
				Math.floor(oz/jug*10+0.5)/10+" ("+jug+" oz) jugs";
			}
		}
	setTooltip(result);
	}

function StatusPcnt(value)
{
	var result;
	if (isNaN(parseInt(value))) 
		result="No water replacement required.";
	else result="Replace "+value+" of your water.";
	setTooltip(result);
	}

function StatusBorax(oz)
{
	var result = StatusWeight(oz);
	oz=parseInt(oz);
	if (document.F.Units.selectedIndex==1) oz/=28.3495;
	if (oz>=76) {
		result=result+" or "+
			Math.floor(oz/76*10+0.5)/10+" (76 oz) boxes";
		}
	setTooltip(result);
	}

function StatusBags(lbs)
{
	var result;
	lbs=parseInt(lbs);
	if (document.F.Units.selectedIndex==1) {
		if (lbs<0) result=lbs+" kg(s)";
		else if (lbs==0) result="None";
		else {
			if (lbs>=25) {
				if (lbs>10*25) lbs=Math.floor((lbs+25/2)/25)*25;
				result=(Math.floor(lbs/25))+" (25 kg) bag";
				if (lbs>=50)
					result=result+"s";
				lbs=lbs-Math.floor(lbs/25)*25;
				if (lbs>0) result=result+
					" and ";
				}
			else result="";
			if (lbs>0) result=result+lbs+" kg(s)";
			}
		}
	else {
		if (lbs<0) result=lbs+" lb(s)";
		else if (lbs==0) result="None";
		else {
			if (lbs>=40) {
				if (lbs>10*40) lbs=Math.floor((lbs+40/2)/40)*40;
				result=(Math.floor(lbs/40))+" (40 lb) bag";
				if (lbs>=80)
					result=result+"s";
				lbs=lbs-Math.floor(lbs/40)*40;
				if (lbs>0) result=result+
					" and ";
				}
			else result="";
			if (lbs>0) result=result+
				lbs+" lb(s)";
			}
		}
	setTooltip(result);
	return result;
	}

function StatusCSI(value)
{
	var result;
	value=parseFloat(value);
	if (value <= -0.6) result="Corrosion of plaster likely";
	else if (value <= -0.3) result="Potential to become corrosive to plaster";
	else if (value < 0.3) result="Balanced";
	else if (value < 0.6) result="Potential to become scaling";
	else if (value >= 0.6) result="Scaling likely";
	else result="Invalid Inputs";
	setTooltip(result);
	}

function StatusSUG(name,value)
{
	setTooltip(name+" FC target "+value);
	}

function StatusEFF()
{
	var oz, unit;

	oz=parseInt(document.F.EFFoz.value);
	unit=eff_units[document.F.EFFpop.selectedIndex];
	if (unit==1) StatusWeight(oz);
	else if (unit==2) StatusBags(oz);
	else StatusVolume(oz);
	}

var GoToField;

function DoGoTo()
{
	GoToField.focus();
	GoToField.select();
	}

function GoTo(field)
{
	GoToField=field;
	setTimeout('DoGoTo()', 50);
	}

function DoLoaded()
{
	RestoreSettings();
	ls="/log____image.gif?summarylog&je="+navigator.javaEnabled()+
		"&sw="+screen.width+"&sh="+screen.height;
	if (screen.pixelDepth) ls+="&sd="+screen.pixelDepth;
	else if (screen.colorDepth) ls+="&sd="+screen.colorDepth;
	if (navigator.language) ls+="&la="+navigator.language;
	else if (navigator.userLanguage) ls+="&la="+navigator.userLanguage;
	if (!document.all) {
		document.cookie="log____cc=1";
		ls+="&co="+(document.cookie?true:false);
		}
	else ls+="&co="+navigator.cookieEnabled;
	if (window.innerWidth) {
		ls+="&ww="+window.innerWidth;
		ls+="&wh="+window.innerHeight;
		}
	else if (document.documentElement && document.documentElement.clientWidth) {
		ls+="&ww="+document.documentElement.clientWidth;
		ls+="&wh="+document.documentElement.clientHeight;
		}
	else if (document.body && document.body.clientWidth) {
		ls+="&ww="+document.body.clientWidth;
		ls+="&wh="+document.body.clientHeight;
		}
	pcnt=parseFloat(document.F.FCpcnt.value);
	document.F.FCtrade.value=(pcnt>9?"trade":"weight");
	li=new Image();
	li.src=ls;
	}

//--></SCRIPT>
</HEAD>
<BODY bgcolor="#FFFFFF" text="#000000" link="#000066" vlink="#333333"
alink="#999999" marginheight=0 topmargin=0 bottommargin=0 marginwidth=0
leftmargin=0 rightmargin=0 onload="DoLoaded();">

<center>
<table width=770 cellpadding=0 cellspacing=0 border=0>
<tr><td align=left>

<header class="site-header" role="banner">
	<div class="header-title">Pool Math</div>
	<a class="brand-link" href="http://www.troublefreepool.com" aria-label="TroubleFreePool home">
		<div class="brand-block">
			<svg class="brand-logo" viewBox="0 0 1623 866" role="img" aria-label="TroubleFreePool logo" focusable="false" xmlns="http://www.w3.org/2000/svg">
				<g fill="currentColor" fill-rule="evenodd">
					<g transform="translate(87.000000, 65.000000)">
						<path d="M1105,62.4094559 C1114.01,60.7373559 1122.47,61.3867559 1131,64.8631559 C1135,66.4947559 1140.6,71.9930559 1145,71.2521559 C1148.3,70.6968559 1151.39,67.4624559 1154,65.5606559 C1159.56,61.5078559 1165.16,57.4731559 1171,53.8346559 C1189.31,42.4317559 1209.23,32.4201559 1230,26.4094559 C1224.29,19.5132559 1214.1,15.7091559 1206,12.2597559 C1181.07,1.64236594 1155.73,-1.11483606 1129,0.37393394 C1120.32,0.85757594 1111.38,2.47268594 1103,4.83767594 C1100.21,5.62551594 1095.81,6.37808594 1094.03,8.91946594 C1091.51,12.5144559 1093.88,19.5006559 1094.61,23.4094559 C1097.1,36.7030559 1100.82,49.5649559 1105,62.4094559 L1105,62.4094559 Z M991,123.409456 C999.228,121.057456 1006.98,116.857456 1015,113.834456 C1031.98,107.431456 1050.85,101.844456 1069,100.409456 C1070.49,93.2304559 1073.01,86.2801559 1077.53,80.4094559 C1080.18,76.9741559 1085.13,73.7737559 1086.21,69.4094559 C1087.39,64.6433559 1083.33,57.0263559 1082,52.4094559 C1078.6,40.6058559 1075.55,28.6152559 1074,16.4094559 C1063.37,20.2776559 1053.75,27.5953559 1045,34.6092559 C1018.64,55.7340559 995.603,89.2254559 991,123.409456 L991,123.409456 Z M1159,99.4094559 C1194.14,102.183456 1232.12,114.924456 1262,133.473456 C1270.33,138.645456 1278.59,144.255456 1286,150.698456 C1290.62,154.721456 1294.39,159.791456 1300,162.409456 C1300,127.928456 1292.49,95.0675559 1272.41,66.4094559 C1267.13,58.8771559 1259.09,45.1544559 1250,42.0274559 C1242.8,39.5523559 1229.71,45.9791559 1223,48.6123559 C1205.31,55.5565559 1188.8,64.1872559 1173,74.7428559 C1168.29,77.8875559 1159.5,82.1128559 1157.13,87.4997559 C1155.64,90.9048559 1158.28,95.9598559 1159,99.4094559 L1159,99.4094559 Z M1110,80.8739559 C1106.17,81.5588559 1102.21,82.8053559 1099,85.0583559 C1076.02,101.190456 1091.51,137.673456 1119,133.083456 C1146.94,128.417456 1146.62,87.7740559 1120,81.3091559 C1116.67,80.4999559 1113.39,80.2687559 1110,80.8739559 L1110,80.8739559 Z M0,229.409456 C13.8408,226.206456 27.3583,220.237456 41,216.129456 C67.6667,208.098456 94.7264,201.059456 122,195.412456 C230.226,173.003456 341.604,169.569456 450,192.620456 C501.863,203.649456 553.23,220.554456 601,243.668456 C659.191,271.823456 713.61,307.749456 775,329.065456 C834.876,349.855456 896.681,363.983456 960,368.320456 C1129.2,379.908456 1303.65,330.472456 1440,229.409456 C1435.86,227.939456 1431.1,230.232456 1427,231.409456 C1418.71,233.789456 1410.3,235.764456 1402,238.119456 C1372.9,246.377456 1342.77,252.613456 1313,257.985456 C1218.12,275.103456 1121.08,283.537456 1025,274.239456 C942.914,266.296456 862.415,246.135456 787,212.548456 C753.989,197.846456 723.064,179.218456 691,162.668456 C662.441,147.927456 632.362,135.293456 602,124.753456 C465.871,77.4955559 314.667,78.4327559 179,126.717456 C132.152,143.390456 87.4068,165.138456 46,192.742456 C30.7402,202.916456 10.7049,214.254456 0,229.409456 L0,229.409456 Z M1158,118.409456 C1156.4,125.151456 1152.99,131.096456 1148.54,136.394456 C1146.18,139.198456 1141.49,141.840456 1140.42,145.448456 C1139.53,148.434456 1141.98,151.867456 1143.25,154.409456 L1152.75,173.409456 C1163.08,194.055456 1174.12,214.371456 1185.58,234.409456 L1194.28,249.409456 C1195.84,252.134456 1197.39,255.733456 1200.21,257.381456 C1203.33,259.203456 1207.64,258.276456 1211,257.833456 C1217.64,256.959456 1224.35,256.555456 1231,255.691456 C1239.33,254.608456 1247.68,253.696456 1256,252.539456 C1259.69,252.026456 1264.52,252.099456 1267.83,250.231456 C1272.3,247.703456 1275.23,241.658456 1277.8,237.409456 C1283.9,227.308456 1288.61,216.586456 1292.33,205.409456 C1293.76,201.127456 1296.13,196.018456 1295.69,191.409456 C1294.93,183.660456 1286.12,176.507456 1281,171.410456 C1265.06,155.540456 1244.82,143.867456 1224,135.613456 C1202.5,127.091456 1180.62,122.623456 1158,118.409456 L1158,118.409456 Z M1034,260.409456 C1034.02,232.290456 1044.92,202.028456 1057.89,177.409456 C1062.75,168.188456 1067.9,159.097456 1073.67,150.409456 C1075.78,147.231456 1080.38,142.492456 1079.99,138.409456 C1079.57,134.001456 1074.36,128.431456 1072.29,124.428456 C1071.44,122.771456 1070.65,120.824456 1068.73,120.183456 C1063.6,118.475456 1054.11,122.313456 1049,123.525456 C1034.03,127.078456 1018.95,131.603456 1005,138.190456 C1000.3,140.409456 994.163,142.539456 990.279,146.046456 C983.599,152.079456 987.603,169.508456 988.729,177.409456 C991.878,199.501456 999.126,220.344456 1010.81,239.409456 C1016.79,249.163456 1022.31,258.198456 1034,260.409456 L1034,260.409456 Z M1053,261.409456 C1067.63,261.449456 1082.38,263.036456 1097,263.394456 C1123.9,264.053456 1151.22,262.522456 1178,260.409456 C1175.39,251.542456 1169.17,243.502456 1164.77,235.409456 C1154.83,217.123456 1144.56,199.030456 1135.25,180.409456 L1125.25,160.409456 C1123.92,157.776456 1122.69,154.276456 1119.79,153.012456 C1116.9,151.757456 1113.06,152.509456 1110,152.370456 C1106.22,152.198456 1100.75,149.396456 1097.18,150.762456 C1094.48,151.798456 1092.85,155.143456 1091.33,157.409456 C1087.64,162.934456 1084.1,168.603456 1080.86,174.409456 C1066.35,200.430456 1053.62,231.181456 1053,261.409456 L1053,261.409456 Z" id="Shape"></path>
						<path d="M0,403.664687 C16.1952,399.918687 32.0398,393.171687 48,388.384687 C73.9908,380.588687 100.436,374.167687 127,368.667687 C233.252,346.666687 343.678,344.265687 450,366.875687 C501.789,377.888687 553.304,394.845687 601,417.923687 C661.19,447.045687 717.382,483.774687 781,505.585687 C844.194,527.251687 910.241,540.701687 977,543.625687 C1140.93,550.803687 1308.12,501.412687 1440,403.664687 C1436.1,402.282687 1431.87,404.262687 1428,405.373687 C1419.69,407.761687 1411.33,409.925687 1403,412.240687 C1373.49,420.439687 1343.13,426.803687 1313,432.240687 C1217.67,449.439687 1120.54,457.719687 1024,448.494687 C943.224,440.776687 863.192,420.845687 789,387.803687 C754.617,372.490687 722.396,353.160687 689,335.923687 C658.94,320.407687 627.038,307.479687 595,296.668687 C462.685,252.019687 313.549,253.153687 182,299.972687 C134.548,316.860687 88.9731,338.349687 47,366.331687 C36.4036,373.395687 25.968,380.733687 16,388.668687 C10.2939,393.211687 4.23153,397.674687 0,403.664687 L0,403.664687 Z" id="Shape"></path>
						<path d="M0,577.463077 C18.9016,573.090077 37.3442,565.338077 56,559.887077 C85.2314,551.346077 115.074,544.681077 145,539.074077 C251.008,519.212077 359.782,519.968077 465,544.114077 C512.298,554.968077 559.323,571.588077 603,592.721077 C636.395,608.880077 667.86,628.523077 701,645.093077 C725.963,657.574077 751.783,668.797077 778,678.410077 C933.095,735.275077 1108.84,728.900077 1263,672.516077 C1307.22,656.343077 1349.62,636.303077 1390,612.063077 C1401.32,605.267077 1412.27,598.012077 1423,590.323077 C1428.89,586.103077 1435.42,582.130077 1440,576.463077 C1432.6,577.109077 1425.16,580.049077 1418,582.039077 C1407.71,584.899077 1397.36,587.499077 1387,590.090077 C1354.94,598.103077 1322.55,604.560077 1290,610.213077 C1180.35,629.257077 1067.79,632.287077 958,613.213077 C895.438,602.344077 834.656,582.628077 777,556.154077 C746.16,541.994077 717.171,524.188077 687,508.722077 C662.875,496.356077 637.457,485.819077 612,476.516077 C527.201,445.529077 435.923,433.394077 346,439.552077 C289.983,443.389077 235.156,456.078077 182,473.796077 C134.573,489.605077 88.5706,512.418077 47,540.130077 C36.3488,547.230077 25.9921,554.657077 16,562.663077 C10.355,567.186077 4.21272,571.532077 0,577.463077 L0,577.463077 Z" id="Shape"></path>
					</g>
				</g>
			</svg>
			<span class="brand-text">TroubleFreePool</span>
		</div>
	</a>
</header>

<div style="
  margin: 16px auto 24px auto;
  padding: 20px 24px;
  max-width: 720px;
  background: linear-gradient(135deg, #e0f4fc 0%, #b8e4f7 100%);
  border: 1px solid #5ba3c8;
  border-radius: 12px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  text-align: center;
  font-size: 14px;
  line-height: 1.6;
">
  <div style="font-size: 18px; font-weight: 600; color: #1a5276; margin-bottom: 12px;">
     Pool Math is better on mobile
  </div>

  <p style="margin: 0 auto 16px auto; max-width: 580px; color: #444; text-align: center;">
    You're viewing the original Pool Math calculator. This page is provided for legacy reference
    and quick calculations, but is no longer actively maintained. Some calculations, targets,
    or recommendations may differ from current Trouble Free Pool guidance.
  </p>

  <p style="margin: 0 0 16px 0; color: #333; font-weight: 500;">
    For fully supported, up-to-date calculations and the best experience,<br>
    download the <strong>Pool Math App</strong>:
  </p>

  <div style="display: flex; justify-content: center; gap: 12px; flex-wrap: wrap;">
    <a href="https://apps.apple.com/app/apple-store/id1228819359?pt=118428848&ct=legacy-calculator&mt=8">
      <img
        src="https://developer.apple.com/assets/elements/badges/download-on-the-app-store.svg"
        alt="Download on the App Store"
        height="44"
        style="border-radius: 6px;">
    </a>
    <a href="https://play.google.com/store/apps/details?id=com.troublefreepool.Pool Math">
      <img
        src="https://upload.wikimedia.org/wikipedia/commons/7/78/Google_Play_Store_badge_EN.svg"
        alt="Get it on Google Play"
        height="44"
        style="border-radius: 6px;">
    </a>
  </div>
</div>

<noscript>
  <h1>Warning  JavaScript must be enabled for Pool Math to work!</h1>
</noscript>

<FORM Method="Get" name="F" action="javascript:CalcAll(); return false;">
<table border=1>

<tr class=ClassHEAD><td></td><td align=center>Now</td><td align=center>Target</td><td align=left>
<INPUT type=button value="Calculate" class=sans onclick="CalcAll(); return false;"></td>
<td align=right>Units&nbsp;<select name="Units" onchange="CalcUnits();">
<option selected>U.S.</option>
<option>Metric</option>
<option>Imperial</option>
</select></td></tr>

<tr class=ClassSIZE><td align=center><strong>Size</strong></td><td colspan=2 align=center><nobr><INPUT type=text name="SIZE" size=6 value="10000" onchange="CalcAll();"><INPUT type=text name="SIZEunit" readonly size=7 value="gallons" class=ClassSIZE onfocus="GoTo(document.F.FCfrom);"></nobr></td><td colspan=2 class=ClassNORM align=center style="padding:12px 16px;"><span style="font-size:13px; color:#666;"> Hover over result fields for unit conversions</span></td></tr>

<tr class=ClassFC>
<td rowspan=2 align=center><strong>FC</strong></td>
<td colspan=2 style="height: 100%;"><center><span class="goal-label">Goal:</span> <span id="FCgoal" class="goal-value not-setup">Not Setup</span></center></td>
<td rowspan=2 colspan=2 align=left style="line-height:2.0; padding:12px 16px;">
<div style="margin-bottom:6px;"><strong>Bleach:</strong></div>
<div style="margin-bottom:8px; padding-left:12px;">Add <INPUT type=text name="FC1oz" size=9 value="0" readonly class=ClassFC onmouseover="withTooltip(this, function() { StatusBleach(document.F.FC1oz.value); });">
of <INPUT type=text name="FCpcnt" size=4 value="6" onchange="CalcFC(); SaveSettings();"> <INPUT type=text name="FCtrade" size=6 value="weight" readonly class=ClassFC> % bleach. Jug size
<select name="FCjug" onchange="SaveSettings();">
<option selected>96 oz</option>
<option>128 oz</option>
<option>174 oz</option>
<option>182 oz</option>
<option>30 oz</option>
<option>64 oz</option>
<option>121 oz</option>
</select></div>
<div style="margin-bottom:6px;"><strong>Or:</strong></div>
<div style="margin-bottom:8px; padding-left:12px;">Add <INPUT type=text name="FC2oz" size=7 value="0" readonly class=ClassFC onmouseover="withTooltip(this, function() { StatusWeight(document.F.FC2oz.value); });"> by weight
or <INPUT type=text name="FC2vol" size=8 value="0" readonly class=ClassFC onmouseover="withTooltip(this, function() { StatusVolume(document.F.FC2vol.value); });"> by volume of
<select name="FCpop" onchange="CalcFC(); SaveSettings();">
<option selected>trichlor</option>
<option>dichlor</option>
<option>cal-hypo 48%</option>
<option>cal-hypo 53%</option>
<option>cal-hypo 65%</option>
<option>cal-hypo 73%</option>
<option>lithium-hypo</option>
<option>chlorine gas</option>
</select></div>
<div style="font-size:13px; color:#666; font-style:italic;">Note: Dichlor and trichlor add CYA and lower pH. Cal-hypo adds CH.</div></td></tr>

<tr class=ClassFC>
<td align=center><INPUT type=text name="FCfrom" size=4 value="4" onchange="CalcFC();"></td>
<td align=center><INPUT type=text name="FCto" size=4 value="4" onchange="CalcFC(); SaveSettings();"></td>
</tr>

<tr class=ClassPH><td rowspan=2 align=center><strong>pH</strong></td>
<td colspan=2 style="height: 100%;"><center><span class="goal-label">Goal:</span> <span id="PHgoal" class="goal-value not-setup">Not Setup</span></center></td>
<td colspan=2 rowspan=2 align=left style="line-height:2.0; padding:12px 16px;">
<div style="margin-bottom:8px; padding-bottom:8px; border-bottom:1px dashed #e5c5d0;">Given TA of <INPUT type=text name="PHTA" size=4 readonly class=ClassPH onmouseover="withTooltip(this, function() { StatusWeight(document.F.PHU1oz.value); });" onfocus="GoTo(document.F.PHfrom);"> and Borate of <INPUT type=text name="PHBOR" size=4 readonly class=ClassPH></div>
<div style="margin-bottom:6px;"><strong>To raise pH:</strong></div>
<div style="margin-bottom:4px; padding-left:12px;">Add <INPUT type=text name="PHU1oz" size=7 value="0" readonly class=ClassPH onmouseover="withTooltip(this, function() { StatusWeight(document.F.PHU1oz.value); });"> by weight
or <INPUT type=text name="PHU1vol" size=7 value="0" readonly class=ClassPH onmouseover="withTooltip(this, function() { StatusVolume(document.F.PHU1vol.value); });"> by volume of washing soda or soda ash</div>
<div style="margin-bottom:8px; padding-left:12px;">Or add <INPUT type=text name="PHU2oz" size=7 value="0" readonly class=ClassPH onmouseover="withTooltip(this, function() { StatusBorax(document.F.PHU2oz.value); });"> by weight
or <INPUT type=text name="PHU2vol" size=8 value="0" readonly class=ClassPH onmouseover="withTooltip(this, function() { StatusVolume(document.F.PHU2vol.value); });"> by volume of borax</div>
<div style="margin-bottom:6px;"><strong>To lower pH:</strong></div>
<div style="margin-bottom:4px; padding-left:12px;">Add <INPUT type=text name="PHD1oz" size=7 value="0" readonly class=ClassPH onmouseover="withTooltip(this, function() { StatusVolume(document.F.PHD1oz.value); });"> of
<select name="MApop" onchange="CalcPH(); SaveSettings();">
<option>15.7% - 10 Baum</option>
<option>28.3% - 18 Baum</option>
<option selected>31.45% - 20 Baum</option>
<option>34.6% - 22 Baum</option>
<option>14.5%</option>
<option>29%</option>
</select> muriatic acid</div>
<div style="margin-bottom:8px; padding-left:12px;">Or add <INPUT type=text name="PHD2oz" size=8 value="0" readonly class=ClassPH onmouseover="withTooltip(this, function() { StatusWeight(document.F.PHD2oz.value); });"> by weight
or <INPUT type=text name="PHD2vol" size=7 value="0" readonly class=ClassPH onmouseover="withTooltip(this, function() { StatusVolume(document.F.PHD2vol.value); });"> by volume of dry acid</div>
<div style="font-size:13px; color:#666; font-style:italic;">Note: pH calculations depend on TA and Borate. Results are approximate and can be off significantly for large pH changes. Changing your pH will also change your TA.</div></td></tr>

<tr class="ClassPH">
<td align=center><INPUT type=text name="PHfrom" size=4 value="7.5" onchange="CalcPH(); CalcCSIfrom();"></td>
<td align=center><INPUT type=text name="PHto" size=4 value="7.5" onchange="CalcPH(); CalcCSIto();"></td>
</tr>

<tr class=ClassTA><td rowspan=2 align=center><strong>TA</strong></td>
<td colspan=2 style="height: 100%;"><center><span class="goal-label">Goal:</span> <span id="TAgoal" class="goal-value not-setup">Not Setup</span></center></td>
<td colspan=2 rowspan=2 align=left style="line-height:2.0; padding:12px 16px;">
<div style="margin-bottom:6px;"><strong>To raise TA:</strong></div>
<div style="margin-bottom:8px; padding-left:12px;">Add <INPUT type=text name="TAoz" size=7 value="0" readonly class=ClassTA onmouseover="withTooltip(this, function() { StatusWeight(document.F.TAoz.value); });" onfocus="GoTo(document.F.TAfrom);"> by weight
or <INPUT type=text name="TAvol" size=8 value="0" readonly class=ClassTA onmouseover="withTooltip(this, function() { StatusVolume(document.F.TAvol.value); });"> by volume of baking soda</div>
<div style="margin-bottom:6px;"><strong>To lower TA:</strong></div>
<div style="margin-bottom:8px; padding-left:12px;">Reduce pH to 7.0-7.2 with acid, then aerate to increase pH</div>
<div style="font-size:13px; color:#666; font-style:italic;">Note: Adding baking soda will also raise your pH just a little.</div></td></tr>

<tr class=ClassTA>
<td align=center><INPUT type=text name="TAfrom" size=4 value="100" onchange="CalcTA(); CalcPH(); CalcCSIfrom();"></td>
<td align=center><INPUT type=text name="TAto" size=4 value="100" onchange="CalcTA(); CalcCSIto();"></td>
</tr>

<tr class=ClassCH><td rowspan=2 align=center><strong>CH</strong></td>
<td colspan=2 style="height: 100%;"><center><span class="goal-label">Goal:</span> <span id="CHgoal" class="goal-value not-setup">Not Setup</span></center></td>
<td colspan=2 rowspan=2 align=left style="line-height:2.0; padding:12px 16px;">
<div style="margin-bottom:6px;"><strong>To raise CH:</strong></div>
<div style="margin-bottom:4px; padding-left:12px;">Add <INPUT type=text name="CH1oz" size=8 value="0" readonly class=ClassCH onmouseover="withTooltip(this, function() { StatusWeight(document.F.CH1oz.value); });" onfocus="GoTo(document.F.CHfrom);"> by weight
or <INPUT type=text name="CH1vol" size=9 value="0" readonly class=ClassCH onmouseover="withTooltip(this, function() { StatusVolume(document.F.CH1vol.value); });"> by volume of calcium chloride</div>
<div style="margin-bottom:8px; padding-left:12px;">Or add <INPUT type=text name="CH2oz" size=8 value="0" readonly class=ClassCH onmouseover="withTooltip(this, function() { StatusWeight(document.F.CH2oz.value); });"> by weight
or <INPUT type=text name="CH2vol" size=9 value="0" readonly class=ClassCH onmouseover="withTooltip(this, function() { StatusVolume(document.F.CH2vol.value); });"> by volume of calcium chloride dihydrate</div>
<div style="margin-bottom:6px;"><strong>To lower CH:</strong></div>
<div style="padding-left:12px;">Replace <INPUT type=text name="CHpcnt" size=5 value="some" readonly class=ClassCH onmouseover="withTooltip(this, function() { StatusPcnt(document.F.CHpcnt.value); });"> of the water with new water (CH of <INPUT type=text name="CHfill" size=4 value="0" onchange="CalcCH(); SaveSettings();">)</div></td></tr>

<tr class=ClassCH>
<td align=center><INPUT type=text name="CHfrom" size=4 value="260" onchange="CalcCH(); CalcCSIfrom();"></td>
<td align=center><INPUT type=text name="CHto" size=4 value="260" onchange="CalcCH(); CalcCSIto();"></td>
</tr>

<tr class=ClassCYA><td rowspan=2 align=center><strong>CYA</strong></td>
<td colspan=2 style="height: 100%;"><center><span class="goal-label">Goal:</span> <span id="CYAgoal" class="goal-value not-setup">Not Setup</span></center></td>
<td colspan=2 rowspan=2 align=left style="line-height:2.0; padding:12px 16px;">
<div style="margin-bottom:6px;"><strong>To raise CYA:</strong></div>
<div style="margin-bottom:4px; padding-left:12px;">Add <INPUT type=text name="CYA1oz" size=7 value="0" readonly class=ClassCYA onmouseover="withTooltip(this, function() { StatusWeight(document.F.CYA1oz.value); });" onfocus="GoTo(document.F.CYAfrom);"> by weight
or <INPUT type=text name="CYA1vol" size=8 value="0" readonly class=ClassCYA onmouseover="withTooltip(this, function() { StatusVolume(document.F.CYA1vol.value); });"> by volume of stabilizer</div>
<div style="margin-bottom:8px; padding-left:12px;">Or add <INPUT type=text name="CYA2oz" size=8 value="0" readonly class=ClassCYA onmouseover="withTooltip(this, function() { StatusVolume(document.F.CYA2oz.value); });"> of liquid stabilizer</div>
<div style="margin-bottom:6px;"><strong>To lower CYA:</strong></div>
<div style="margin-bottom:8px; padding-left:12px;">Replace <INPUT type=text name="CYApcnt" size=4 value="some" readonly class=ClassCYA onmouseover="withTooltip(this, function() { StatusPcnt(document.F.CYApcnt.value); });"> of the water with new water</div>
<div style="font-size:13px; color:#666; font-style:italic;">Note: It can take solid stabilizer up to a week to dissolve. It will also lower your pH.</div></td></tr>

<tr class=ClassCYA>
<td align=center><INPUT type=text name="CYAfrom" size=4 value="40" onchange="CalcCYA(); CalcCSIfrom(); CalcSUG();"></td>
<td align=center><INPUT type=text name="CYAto" size=4 value="40" onchange="CalcCYA(); CalcCSIto();"></td>
</tr>

<tr class=ClassSALT><td align=center><strong>Salt</strong></td><td align=center><INPUT type=text name="SALTfrom" size=5 value="0" onchange="CalcSALT(); CalcCSIfrom();"></td><td align=center><INPUT type=text name="SALTto" size=5 value="0" onchange="CalcSALT(); CalcCSIto();"></td><td colspan=2 align=left style="line-height:2.0; padding:12px 16px;">
<div style="margin-bottom:6px;"><strong>To raise Salt:</strong></div>
<div style="margin-bottom:8px; padding-left:12px;">Add <INPUT type=text name="SALTlb" size=8 value="0" readonly class=ClassSALT onmouseover="withTooltip(this, function() { StatusBags(document.F.SALTlb.value); });" onfocus="GoTo(document.F.BORfrom);"> of salt</div>
<div style="margin-bottom:6px;"><strong>To lower Salt:</strong></div>
<div style="padding-left:12px;">Replace <INPUT type=text name="SALTpcnt" size=4 value="some" readonly class=ClassSALT onmouseover="withTooltip(this, function() { StatusPcnt(document.F.SALTpcnt.value); });"> of the water with new water</div></td></tr>

<tr class=ClassBOR><td align=center><strong>Borate</strong></td><td align=center><INPUT type=text name="BORfrom" size=4 value="0" onchange="CalcBOR(); CalcPH(); CalcCSIfrom();"></td><td align=center><INPUT type=text name="BORto" size=4 value="0" onchange="CalcBOR(); CalcCSIto();"></td><td colspan=2 align=left style="line-height:2.0; padding:12px 16px;">
<div style="margin-bottom:6px;"><strong>To raise Borate:</strong></div>
<div style="margin-bottom:4px; padding-left:12px;">Add <INPUT type=text name="BORoz" size=8 value="0" readonly class=ClassBOR onmouseover="withTooltip(this, function() { StatusBorax(document.F.BORoz.value); });" onfocus="GoTo(document.F.TEMP);"> by weight
or <INPUT type=text name="BORvol" size=9 value="0" readonly class=ClassBOR onmouseover="withTooltip(this, function() { StatusVolume(document.F.BORvol.value); });"> by volume of <select name="BORpop" onchange="CalcBOR(); SaveSettings();">
<option selected>borax</option>
<option>boric acid</option>
<option>tetraborate pentahydrate</option>
</select></div>
<div style="margin-bottom:8px; padding-left:12px;">Plus <INPUT type=text name="BORacid" size=8 value="0" readonly class=ClassBOR onmouseover="withTooltip(this, function() { StatusVolume(document.F.BORacid.value); });"> of 31.45% muriatic acid to compensate for pH increase</div>
<div style="margin-bottom:6px;"><strong>To lower Borate:</strong></div>
<div style="margin-bottom:8px; padding-left:12px;">Replace <INPUT type=text name="BORpcnt" size=4 value="some" readonly class=ClassBOR onmouseover="withTooltip(this, function() { StatusPcnt(document.F.BORpcnt.value); });"> of the water with new water</div>
<div style="font-size:13px; color:#666; font-style:italic;">Note: The pH should be tested and adjusted as needed after increasing the borate level.</div></td></tr>

<tr class=ClassTEMP><td align=center><strong>Temp</strong></td><td colspan=2 align=center><nobr><INPUT type=text name="TEMP" size=3 value="84" onchange="CalcCSIfrom(); CalcCSIto();"><input type=text name="TEMPunit" size=10 readonly value="Fahrenheit" class=ClassTEMP onfocus="GoTo(document.F.SZwid);"></nobr></td><td colspan=2 class=ClassNORM align=center style="padding:12px 16px;"><span style="font-size:13px; color:#666;">Water temperature for CSI calculation</span></td></tr>

<tr class=ClassCSI><td align=center><strong>CSI</strong></td><td align=center><INPUT type=text name="CSIfrom" size=5 value="0" readonly class=ClassCSI onmouseover="withTooltip(this, function() { StatusCSI(document.F.CSIfrom.value); });"></td><td align=center><INPUT type=text name="CSIto" size=5 value="0" readonly class=ClassCSI onmouseover="withTooltip(this, function() { StatusCSI(document.F.CSIto.value); });"></td><td colspan=2 align=left style="line-height:2.0; padding:12px 16px;">
<div style="margin-bottom:6px;"><strong>Calcite Saturation Index</strong> <span style="color:#666;">(requires pH, TA, CH, CYA, Temp; uses Borate, Salt)</span></div>
<div style="padding-left:12px;"> Less than <strong>-0.6</strong>: Potential problems for plaster, tile, stone, and pebble pools</div>
<div style="padding-left:12px;"> Greater than <strong>+0.6</strong>: Potential problems for all pools</div></td></tr>

<tr class=ClassSUG><td colspan=3 align=center>Suggested FC Levels</td>
<td colspan=2 align=left style="line-height:2.0; padding:12px 16px;">
<div style="margin-bottom:10px;">
<div style="margin-bottom:6px;"><strong>SWG:</strong> <INPUT type=text name="SUGFCswg" size=4 value="2" readonly class=ClassCH onmouseover="withTooltip(this, function() { StatusSUG('SWG',document.F.SUGFCswg.value); });"></div>
<div style="margin-bottom:6px;"><strong>Normal:</strong> <INPUT type=text name="SUGFCmin" size=4 value="3" readonly class=ClassSUG onmouseover="withTooltip(this, function() { StatusSUG('Minimum',document.F.SUGFCmin.value); });"> to <INPUT type=text name="SUGFCtarg" size=4 value="6" readonly class=ClassSUG onmouseover="withTooltip(this, function() { StatusSUG('Maximum',document.F.SUGFCtarg.value); });"></div>
<div style="margin-bottom:6px;"><strong>Shock:</strong> <INPUT type=text name="SUGFCshock" size=4 value="15" readonly class=ClassSUG onmouseover="withTooltip(this, function() { StatusSUG('Shock',document.F.SUGFCshock.value); });"></div>
<div><strong>Mustard Algae:</strong> <INPUT type=text name="SUGFCmust" size=4 value="24" readonly class=ClassSUG onmouseover="withTooltip(this, function() { StatusSUG('Mustard Algae Shock',document.F.SUGFCmust.value); });"></div>
</div>
<div style="font-size:13px; color:#666;">Suggested target FC levels based on the current CYA level for outdoor pools.</div>
<div style="font-size:13px; color:#666; font-style:italic; margin-top:4px;">Note: Be careful if your CYA is really and truly zero! With CYA above 90 we recommend replacing water to get CYA down before you start the SLAM process.</div></td></tr>

<tr class=ClassGOALS><td colspan=3 align=center>Suggested Goal Levels</td>
<td colspan=2 align=left style="line-height:2.0; padding:12px 16px;">
<div style="display:grid; grid-template-columns:auto 1fr; gap:6px 12px; margin-bottom:10px; align-items:center;">
<strong>Goal levels from:</strong>
<select name="FROMpop" onchange="CalcGOAL(); SaveSettings();">
<option selected>Not Setup</option>
<option>Traditional Pool</option>
<option>TroubleFreePool.com</option>
<option>Traditional Spa</option>
</select>
<strong>Chlorine source:</strong>
<select name="CHLORINEpop" onchange="CalcSUG(); CalcGOAL(); SaveSettings();">
<option selected>Not Setup</option>
<option>Bleach</option>
<option>SWG</option>
<option>Trichlor</option>
</select>
<strong>Pool surface:</strong>
<select name="SURFACEpop" onchange="CalcGOAL(); SaveSettings();">
<option selected>Not Setup</option>
<option>Plaster</option>
<option>Vinyl</option>
<option>Fiberglass</option>
</select>
</div>
<div style="font-size:13px; color:#666; font-style:italic;">Note: Suggested goals are simply a starting point. There are many situations that are not covered by these basic guidelines.</div>
</td></tr>

</table>

<div style="margin:20px 0; padding:16px 20px; background:linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%); border:1px solid #e2e8f0; border-radius:10px; box-shadow:0 2px 4px rgba(0,0,0,0.04);">
<h3 style="margin:0 0 8px 0; font-size:15px; color:#475569;"> Notes</h3>
<p style="margin:0; font-size:14px; color:#64748b; line-height:1.6;">Unless you are SLAMing your pool, it is always best to add less than the full amount, wait a little while to allow the addition to mix thoroughly, and then retest to see where you are. Also, keep in mind that the volume of powders can vary from manufacturer to manufacturer.</p>
</div>

<div style="margin:20px 0; padding:16px 20px; background:linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%); border:1px solid #bfdbfe; border-radius:10px; box-shadow:0 2px 4px rgba(0,0,0,0.04);">
<h3 style="margin:0 0 12px 0; font-size:15px; color:#1e40af;"> Estimating Pool Volume</h3>
<div style="display:flex; flex-wrap:wrap; gap:12px 20px; align-items:center; margin-bottom:12px;">
<div style="display:flex; align-items:center; gap:6px;">
<label style="font-weight:500; color:#374151;">Width:</label>
<INPUT type=text name="SZwid" size=4 value="0" onchange="CalcSZ();" style="width:60px;">
<INPUT type=text name="SZunit1" size=2 value="ft" readonly onfocus="GoTo((document.F.SZpop.selectedIndex==2)?document.F.SZdeep:document.F.SZlen);" style="width:30px; border:none; background:transparent; padding:0;">
</div>
<div style="display:flex; align-items:center; gap:6px;">
<label style="font-weight:500; color:#374151;">Length:</label>
<INPUT type=text name="SZlen" size=4 value="0" onchange="CalcSZ();" style="width:60px;">
<INPUT type=text name="SZunit2" size=2 value="ft" readonly onfocus="GoTo(document.F.SZdeep);" style="width:30px; border:none; background:transparent; padding:0;">
</div>
<div style="display:flex; align-items:center; gap:6px;">
<label style="font-weight:500; color:#374151;">Depth:</label>
<INPUT type=text name=SZdeep size=4 value="0" onchange="CalcSZ();" style="width:60px;">
<INPUT type=text name="SZunit3" size=2 value="ft" readonly onfocus="GoTo(document.F.SZvol);" style="width:30px; border:none; background:transparent; padding:0;">
</div>
</div>
<div style="display:flex; align-items:center; gap:6px; margin-bottom:12px;">
<label style="font-weight:500; color:#374151;">Shape:</label>
<select name="SZpop" onchange="CalcSZ();">
<option selected>rectangular</option>
<option>oval</option>
<option>round (ignores length)</option>
</select>
</div>
<div style="display:flex; align-items:center; gap:8px; padding:10px 12px; background:rgba(255,255,255,0.6); border-radius:6px; margin-bottom:12px;">
<label style="font-weight:600; color:#1e40af;">Volume:</label>
<INPUT type=text name="SZvol" size=14 value="0" readonly style="font-weight:500; font-size:15px;">
</div>
<p style="margin:0; font-size:13px; color:#64748b; line-height:1.5;">If the depth varies, use the average depth of the pool. A good approximation is the shallow end depth plus the deep end depth divided by two. Irregularly shaped pools can be approximated by estimating the average length and width and using rectangular.</p>
</div>

<div style="margin:20px 0; padding:16px 20px; background:linear-gradient(135deg, #fefce8 0%, #fef9c3 100%); border:1px solid #fde047; border-radius:10px; box-shadow:0 2px 4px rgba(0,0,0,0.04);">
<h3 style="margin:0 0 12px 0; font-size:15px; color:#a16207;"> Effects of Adding Chemicals</h3>
<div style="margin-bottom:12px;">
Adding <INPUT type=text name="EFFoz" size=6 value="0" onchange="CalcEFF();"> <INPUT type=text name="EFFunit" size=3 value="oz" readonly> of <select name="EFFpop" onchange="CalcEFF();">
<option>5.25% bleach</option>
<option selected>6% bleach</option>
<option>8.25% bleach</option>
<option>10% bleach</option>
<option>12.5% bleach</option>
<option>trichlor</option>
<option>dichlor</option>
<option>48% cal-hypo</option>
<option>53% cal-hypo</option>
<option>65% cal-hypo</option>
<option>73% cal-hypo</option>
<option>lithium hypochlorite</option>
<option>chlorine gas</option>
<option>15.7% muriatic acid</option>
<option>31.45% muriatic acid</option>
<option>dry acid</option>
<option>washing soda or soda ash</option>
<option>borax (20 Mule Team)</option>
<option>sodium tetraborate pentahydrate</option>
<option>boric acid</option>
<option>caustic soda (lye)</option>
<option>baking soda</option>
<option>calcium chloride</option>
<option>calcium chloride dihydrate</option>
<option>stabilizer</option>
<option>liquid stabilizer</option>
<option>salt</option>
</select><br>
<div style="margin-top:10px;"><strong>Result:</strong> <INPUT type=text name="EFFresult" size=70 onfocus="GoTo(document.F.SIZE);" readonly style="width:100%; max-width:500px;"></div>
</div>
<p style="margin:0; font-size:13px; color:#64748b; line-height:1.5;">Note: pH calculations are not exact. These numbers are only suggestive of the relative magnitude of the pH change you can expect. Small changes, 0.4, with pH between 7.2-7.8, TA around 80-120, and Borate near zero will be approximately correct. The further you go from those ranges the less these pH changes will correspond to reality.</p>
</div>

</FORM>

<p>Copyright  2007-2010 by Jason T. Linhart. Copyright  2013-2015 by TroubleFreePool.com. All rights reserved. Updated, 
September 17 2015.</p>

</td></tr></table>
</center>
<noscript><img src="/log____image.gif?summarylog&amp;js=false" alt=""></noscript>
</BODY>
</HTML>
